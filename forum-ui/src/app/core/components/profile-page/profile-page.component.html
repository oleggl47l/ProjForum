<tui-loader [showLoader]="isLoading()" class="profile-loader">
  <div class="profile-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="profile-header">
      <div class="header-content">
        <h1 class="profile-title">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
        <p class="profile-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</p>
      </div>

      @if (userData()) {
        <div class="user-header-info">
          <div class="user-avatar-wrapper">
            <div class="user-avatar">
              {{ userData()!.userName!.charAt(0) }}
            </div>
            <div class="user-status-indicator" [class.active]="userData()?.active"></div>
          </div>
          <div class="user-info-short">
            <h2 class="user-name">{{ userData()!.userName }}</h2>
            <div class="user-email">{{ userData()?.email }}</div>
          </div>
        </div>
      }
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
    @if (errorMessage()) {
      <div class="error-notification">
        {{ errorMessage() }}
      </div>
    }

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="profile-content">
      <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
      <div class="sidebar">
        <nav class="sidebar-nav">
          <button
            class="nav-item"
            [class.active]="activeItemIndex() === 0"
            (click)="onActiveItemIndexChange(0)"
          >
            <span class="nav-text">–ü—Ä–æ—Ñ–∏–ª—å</span>
          </button>
          <button
            class="nav-item"
            [class.active]="activeItemIndex() === 1"
            (click)="onActiveItemIndexChange(1)"
          >
            <span class="nav-text">–ú–æ–∏ –ø–æ—Å—Ç—ã</span>
          </button>
          <div class="nav-divider"></div>
          <button
            class="nav-item logout-item"
            (click)="onLogout()"
            [disabled]="isLoading()"
          >
            <span class="nav-text">
              @if (isLoading()) {
                –í—ã—Ö–æ–¥...
              } @else {
                –í—ã–π—Ç–∏
              }
            </span>
          </button>
        </nav>
      </div>

      <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
      <div class="main-content">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è -->
        @if (activeItemIndex() === 0 && userData()) {
          <div class="profile-tab-content">
            <div class="profile-card">
              <div class="card-header">
                <h2 class="card-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ñ–∏–ª–µ</h2>
                <div class="card-subtitle">–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</div>
              </div>

              <div class="info-grid">
                <div class="info-card">
                  <div class="info-card-header">
                    <h3 class="info-card-title">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                  </div>
                  <div class="info-card-content">
                    <div class="info-row">
                      <span class="info-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                      <span class="info-value">{{ userData()?.userName }}</span>
                    </div>
                    <div class="info-row">
                      <span class="info-label">Email</span>
                      <span class="info-value">{{ userData()?.email }}</span>
                    </div>
                  </div>
                </div>

                <div class="info-card">
                  <div class="info-card-header">
                    <h3 class="info-card-title">–°—Ç–∞—Ç—É—Å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                  </div>
                  <div class="info-card-content">
                    <div class="info-row">
                      <span class="info-label">–°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞</span>
                      <div class="info-value">
                        <span class="status-badge" [class.active]="userData()?.active">
                          {{ userData()?.active ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}
                        </span>
                      </div>
                    </div>
                    @if (userData()?.roles && userData()!.roles!.length > 0) {
                      <div class="info-row">
                        <span class="info-label">–†–æ–ª–∏</span>
                        <div class="roles-container">
                          @for (role of userData()!.roles; track role) {
                            <span class="role-tag">{{ role }}</span>
                          }
                        </div>
                      </div>
                    }
                  </div>
                </div>

                <div class="info-card stats-card">
                  <div class="info-card-header">
                    <h3 class="info-card-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                  </div>
                  <div class="info-card-content">
                    <div class="stats-grid">
                      <div class="stat-item">
                        <div class="stat-value">{{ posts().length }}</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-value">0</div>
                        <div class="stat-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-value">100%</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        }

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –ø–æ—Å—Ç–æ–≤ -->
        @if (activeItemIndex() === 1) {
          <div class="posts-tab-content">
            <div class="posts-header">
              <h2 class="posts-title">–ú–æ–∏ –ø–æ—Å—Ç—ã</h2>
              <div class="posts-actions">
                <button tuiButton size="s" class="new-post-button" disabled>
                  + –ù–æ–≤—ã–π –ø–æ—Å—Ç
                </button>
              </div>
            </div>

            @if (posts().length > 0) {
              <div class="posts-list-container">
                <div class="posts-list">
                  @for (post of posts(); track post.id) {
                    <div class="post-card">
                      <div class="post-header">
                        <div class="post-meta">
                          <h3 class="post-title">{{ post.title }}</h3>
                          <div class="post-date">{{ post.date }}</div>
                        </div>
                        <div class="post-actions">
                          <button tuiButton size="xs" appearance="flat" disabled>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                          <button tuiButton size="xs" appearance="flat" class="delete-button" disabled>–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                      </div>
                      <div class="post-content">
                        {{ post.content }}
                      </div>
                      <div class="post-footer">
                        <div class="post-stats">
                          @if (post.category) {
                            <span class="stat">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: {{ post.category }}</span>
                          }
                          @if (post.tags && post.tags.length > 0) {
                            <span class="stat">–¢–µ–≥–∏: {{ post.tags.join(', ') }}</span>
                          }
                          <span class="stat">
                    {{ post.isPublished ? '‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω' : 'üìù –ß–µ—Ä–Ω–æ–≤–∏–∫' }}
                  </span>
                        </div>
                      </div>
                    </div>
                  }
                </div>
              </div>
            } @else {
              <div class="posts-notification">
                <div class="notification-icon">üìù</div>
                <div class="notification-content">
                  <h4>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</h4>
                  <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –º—ã—Å–ª—è–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º</p>
                </div>
              </div>

              <div class="empty-posts">
                <div class="empty-icon">üìù</div>
                <h3>–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –º—ã—Å–ª—è–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º</p>
                <button tuiButton size="m" class="create-first-post" disabled>
                  –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç
                </button>
              </div>
            }
          </div>
        }
      </div>
    </div>
  </div>
</tui-loader>
